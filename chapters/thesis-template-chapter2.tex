 \chapter{Разработка моделей и алгоритмов \dots}

В этой главе описываются разработанные/модифицированные модели/методы/
алгоритмы, или/и описывается применение известных стандартных методов. Также, 
в конце главы обычно приводится общая архитектура программной системы, 
вытекающая из описанной теории. Приведенные ниже заголовки подразделов так же 
весьма примерные и сильно зависят от особенностей конкретной работы.

Формулы и их части необходимо набирать в математическом режиме
(символ \verb|$|). Во избежание переноса длинных формул между строками их 
стоит размещать по центру колонки, например,
\begin{center}
$S a b c = (\lambda x y z. x z (y z)) a b c = a c (b c)$,
\end{center}
\noindent и, если абзац после формулы продолжается, необходимо использовать 
\verb|\noindent|.

Для набора правил вывода можно использовать пакет \texttt{mathpartir.sty}. 
Правила вывода могут быть вынесены в виде рисунка (см. рис. 
\ref{img:inferrules}).

\begin{figure}[t]
  \centering
    \begin{mathpar}
      \inferrule{
        M \to M'
      }{
        N M \to N M'
      } \quad (\mu) \and 
      \inferrule{
        M \to M'
      }{
        M N \to M' N
      } \quad (\nu) \and
      \inferrule{
        M \to M'
      }{
        \lambda x. M \to \lambda x. M'
      } \quad (\xi)
    \end{mathpar}
  \caption{Правила редукции}
  \label{img:inferrules}
\end{figure}

Для оформления определений, теорем, доказательств и т.~п. могут быть 
использованы соответствующие окружения, например:



\section{Формальная постановка задачи геолокации по серии изображений}

Задача геолокации (визуальной локализации) в данном исследовании ставится как задача классификации изображений местности в соответствующие им области земной поверхности. Более формально:

\begin{compactitem}
	
	\item $K$ --- число испытуемых,
	\item $N$ --- число временных отсчётов в которые сделаны фМРТ-изображения,
	\item $M$ --- число вокселей в изображении,
	\item $\mathcal{Y}$ --- множество всех классов в эксперименте
	
\end{compactitem}
Пусть \[\mathcal{X}\] - Множество входных

\section{Выбор/разработка методов оценки точности работы алгоритмов геолокации}

\dots


\section{Модификация существующих решений в области для работы с серией изображений}

Хотя разрабатываемая архитектура способна локализовать большое разнообразие изображений, многие изображения неоднозначны или не предоставляют достаточно информации, которая позволила бы их локализовать.
Однако мы можем использовать тот факт, что фотографии естественным образом происходят в последовательности, например, альбомы, место съёмки которых часто значительно скоррелировано. Интуитивно, если мы с уверенностью можем локализовать
некоторые из фотографий в альбоме, мы можем использовать эту информацию,
чтобы локализовать фотографии с неопределенным местоположением. Фотографии в альбоме --- это последовательность,
которая требует модели, которая запоминает состояние предыдущего примера, 
при рассмотрении текущего примера. Поэтому целесообразно использовать
(LSTM) \cite{hochreiter1997long} для этой задачи.
Теперь мы рассмотрим, как решить проблему прогнозирования
геолокации последовательности фотографий с использованием LSTM.

\subsection{Архитектура Модели}
Основная структура нашей модели такова:
учитывая изображение, мы извлекаем вектор признаков изображения (до слоя SoftMax) в PlaNet. Этот вектор подается в блок LSTM. Выходной вектор LSTM затем подаётся в слой SoftMax, который
выполняет классификацию в ячейки S2. Мы подаём альбом в модель в хронологическом порядке. В генерации признаков мы переиспользуем параметры модели для одиночного изображения. Во время обучения мы сохраняем их фиксированными и только обучать параметры LSTM и слой SoftMax.
\subsection{Результаты} Мы сравниваем эту модель с одноканальным PlaNet
модель и базовый уровень, который просто усредняет прогнозы single-imagePlaNet всех изображений в альбоме и назначает
среднее для всех изображений. Результаты показаны в табл.4 (сначала
3 ряда). Усреднение в альбомах («PlaNet avg») уже
дают значительное улучшение по сравнению с одним изображением PlaNet
(45,7\% на уровне улиц), поскольку у него больше
вмятины предсказания к неоднозначным изображениям. Однако, LSTM
модель явно превосходит технику усреднения (50,5\%
относительное улучшение уровня улицы). Визуальный контроль
результатов показали, что за достоверностью следуют несколько изображений с более низким местоположением уверенность, модель LSTM присваивает низкий уровень доверия изображения, расположенные вблизи изображения с высокой степенью достоверности в то время как оригинальная модель PlaNet «прыгать» (меняет предположение о расположении альбома), модель LSTM имеет тенденцию прогнозировать близкие местоположения, кроме случаев когда
есть убедительные доказательства изменения местоположения. LSTM
модель превосходит усреднение из-за того что оно присваивает всем изображениям в альбоме одинаковые уровни значимости и не может производить точные прогнозы для альбомов которые включают разные местоположения (например, альбомы поездок).

Проблема с этой простой моделью LSTM заключается в том, что многие
альбомы содержат вначале несколько изображений, которые
не содержат полезной визуальной информации. Благодаря своей однонаправленности эта модель не может исправить неверные прогнозы, что
происходят в начале последовательности после наблюдения
фото с уверенным местоположением. По этой причине мы сейчас
оценить модель, в которой LSTM использует множество фотографий
от альбома, прежде чем сделать свое первое предсказание.
Смещение метки. Идея этой модели состоит в том, чтобы сдвинуть la
поиск поисков, что вывод отложен на несколько временных шагов
(Рисунок 11b). Основная мотивация этой идеи состоит в том, что
модель может накапливать информацию из нескольких изображений в
последовательность перед предсказаниями. Тем не менее, мы
обнаружили, что использование смещений не улучшает локализацию
(Таблица 4, LSTM off1, LSTM off2). Предположим, что
из-за ввода входного изображения на выходные метки
становится более сложным, затрудняя прогнозирование
для всех фотографий, улучшая прогнозы только для конечности
количество фотографий. Более того, этот подход не
решить проблему повсеместно: например, если мы компенсируем
метка на 2 шага, но первое изображение
Фертильность возникает только после 3 шагов, прогноз для первого
изображение, вероятно, все еще будет неправильным. Чтобы исправить это, теперь мы
сидером, которые определяют их прогнозы на всех изображениях
в последовательности, а не только предыдущие. Повторяющиеся последовательности. Сначала мы оцениваем модель, которая
обученный по последовательностям
включая два экземпляра одной и той же последовательности (рисунок 11c). для
эта модель, мы принимаем только прогнозы для изображений из
вторая половина последовательности (т. е. повторяющаяся часть). ТАКИМ,
Все предсказания обусловлены наблюдениями всех
возрастов. 

При времени вывода, передавая последовательность в модель
в первый раз можно рассматривать как стадию кодирования, где
LSTM создает внутреннее состояние на основе изображений.
Второй проход представляет собой этап декодирования, где на каждом изображении,
LSTM делает прогноз на основе его состояния,
аренда изображение. Результаты показывают, что этот подход превосходит
однопроходные LSTM (вкладка 4, LSTM rep), достигающие 7,8%
относительное улучшение на уровне улицы, ценой двоякого
увеличение времени вывода. Однако,
В результате мы обнаружили проблему с этим подходом:
если в начале
последовательности, они, как правило, привязаны к последнему
катиона в последовательности, поскольку модель учится полагаться на
его предыдущее предсказание. Поэтому прогнозы с конца
последовательности переносятся в начало.
Двунаправленный LSTM. Известная нейронная сеть ar-
архитектуры, которая обусловливает прогнозы в целом
последовательности являются двунаправленными LSTM (BLSTM) [15]. Эта
модель можно рассматривать как конкатенацию двух моделей LSTM mod-
els, где первый выполняет передний проход, а второй выполняет обратный проход по последовательности (рис.11d). двунаправленные LSTM не могут быть обучены с усеченными во времени [12] и, следовательно, для
LSTM до полной длины последовательности. Чтобы уменьшить
вычислительную стоимость обучения, нам пришлось ограничить продолжительность
последовательности до 25 изображений. Это приводит к снижению общего
точность, поскольку более длинные альбомы обычно дают
более короткими. Поскольку наши эксперименты по этим данным
не сопоставимы с предыдущими, мы также
оценить повторяющуюся модель LSTM на усеченных последовательностях
до 25 изображений. Как показывают результаты BLSTM явно превосходят повторные LSTM
(Относительное улучшение на уровне улицы на 16,6\%). Однако,
потому что они не подходят для длинных последовательностей, повторяющиеся
модель может быть предпочтительнее на практике.


\section{Разработка метода геолокации по серии изображений используя выбранные/разработанные выше алгоритмы/методы}

В ряде случаев, все или некоторые результаты проектирования могут быть представлены во второй главе. Обычно же архитектура описывается в третьей главе.

\section{Выводы}

Необходимо перечислить, какие теоретические результаты были получены с 
указанием степени новизны. Например: <<Была разработана такая-то модель. Она 
представляет собой адаптированную версию модели $X$, в которой уравнение $Z$ 
заменено на уравнение $Z'$>>. Еще пример: <<Была предложена такая-то 
архитектура, она отличается от типовой в том-то и том-то. Это позволяет 
избежать таких-то проблем.>>. При этом не следует заниматься <<высасыванием из 
пальца>>: <<Поставленная задача является типовой; для ее решения применены 
стандартные средства (перечислить, какие).>>.
